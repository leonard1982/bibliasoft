# CHANGELOG

## 2026-02-18
- Rediseño de Inicio como landing profesional:
  - Mensaje de valor, beneficios concretos, características y llamados a la acción.
  - Mantiene tarjeta de versículo del día sin forzar redirección automática al lector.
- Mejora fuerte de Anécdotas:
  - Render visual más rico (tarjetas por tema, párrafos legibles, destaque de idea y aplicación).
  - Enriquecimiento automático de anécdotas seed genéricas para evitar repetición visible.
  - Generador fallback con historias más emocionales y aplicables por tema.
- Devocionales más completos y con mejor presentación:
  - Nueva estructura visual con portada del pasaje y bloques de contenido.
  - Secciones ampliadas: contexto literario, oración sugerida y desafío semanal.
  - Historial con vista rápida para reabrir devocionales previos.
- Corrección de generación:
  - El contenido de `Generar explicación` ya no devuelve placeholders antiguos.
  - Se invalida caché de respuestas base y se regenera contenido contextual útil.
- Registro/Login visible en UI:
  - Nuevas rutas y vistas: `Ingresar`, `Registro`, `Salir`, `Admin`.
  - Sesión activa para acciones personales (favoritos de anécdotas).
- Compartir App por QR:
  - Nueva vista `?route=share_app`.
  - QR local (librería local `public/assets/vendor/qrcode.min.js`) usando `APP_PUBLIC_URL`.
  - Botones `Copiar enlace` y `Compartir` + guía de instalación PWA (Android/iPhone).
- Módulo Anécdotas:
  - Nueva vista `?route=anecdotes`.
  - Seed local: `data/anecdotas_seed.json` (64 anécdotas originales por tema).
  - Filtros por tema y búsqueda.
  - Acciones: `Copiar`, `Guardar`, `Compartir`.
  - Generación bajo demanda (`api.anecdotes.generate`) y favoritos (`api.anecdotes.favorite`).
  - Nuevas tablas: `anecdotes`, `anecdote_favorites`.
- Comentarios con control legal:
  - Nueva configuración `config/sources.php`.
  - `cmti` desactivado por defecto (licencia no verificada).
  - Fallback de comentario contextual con etiqueta `Fuente: Generado`.
  - Nueva documentación: `docs/LICENCIAS_COMENTARIOS.md`.
- Fixes UI/Responsive:
  - Al ocultar Ayuda, el lector central se expande al ancho disponible.
  - Ajuste de columna de capítulos para mostrar correctamente el label.
  - En móvil, toolbar del lector muestra solo íconos con `title/aria-label`.
  - Tap en versículo (móvil) abre ayuda automáticamente y enfoca `Contexto`.
  - Alineación del versículo 1: número y texto en misma línea.
- Extensión de accesibilidad y contenido diario:
  - Control de letra en Herramientas (`A+`, `A-`, `Restablecer`), rango 85%-150%, persistencia local.
  - Atajos `Ctrl+=` y `Ctrl+-` para ajuste rápido.
  - Escala aplicada al lector, comentarios y vista de devocionales (global desde preferencias guardadas).
- Generador de imagen de versículo:
  - Fondos locales en `public/assets/backgrounds/`.
  - Selector de estilo para tarjeta (`Modo oscuro` / `Modo claro`).
  - Descarga PNG, compartir (Web Share) y copiar imagen (fallback descarga).
- Página de inicio “Versículo del día”:
  - Vista `views/home_daily.php` con tarjeta destacada.
  - Botones: `Leer contexto`, `Compartir`, `Ir a lectura`, `No mostrar más hoy`.
  - Cache diaria en tabla `daily_cache`.
- Nuevo módulo “Devocionales”:
  - Vista `views/devotional.php`.
  - Generación diaria con estructura fija (A-F).
  - Historial persistido en tabla `devotionals`.
  - Compartir como texto e imagen.
- Configuración ampliada:
  - Toggle `Mostrar Versículo del día al iniciar`.
  - Toggle `Activar devocionales automáticos`.
  - Mensaje de seguridad para token vía `.env`.
- Nuevos servicios:
  - `DailyVerseService`
  - `DevotionalService`
  - `ImageCardService`
- Persistencia adicional:
  - Tabla `user_prefs` (font_scale, show_daily, auto_devotional, theme).
  - Endpoint `api.prefs.save`.
- Rebranding completo:
  - Nombre principal: `Biblia para todos`
  - Branding alterno: `BibliaSoft`
  - Slogan visible: `Biblia para todos`
- Nuevo layout lector profesional:
  - 3 columnas fijas en escritorio (Libros / Capítulos / Lectura + panel de ayuda)
  - drawer adaptado en móvil para navegación y ayuda
- Selección avanzada de versículos:
  - selección múltiple con `Shift+click`
  - `Copiar selección`, `Copiar como párrafo`, `Compartir`
- Panel de ayuda por pestañas:
  - `Contexto`, `Comentarios`, `Mis notas`, `Vincular`, `Herramientas`
  - Notas por rango con etiquetas
  - Vínculos manuales por rango
- PWA instalable y offline:
  - `manifest.json`
  - `sw.js`
  - cache de assets y capítulos consultados
  - acciones de “Generar…” deshabilitadas sin conexión
- Búsqueda avanzada con atajo `Ctrl+K`:
  - filtros por modo de búsqueda, libro y rango de capítulos
  - apertura directa al resultado
- Integración segura de generación por API:
  - endpoint `public/api/generate.php`
  - carga de `.env` sin hardcodear claves
  - cache en `ai_cache` por libro/capítulo/rango/modo/prompt_hash
- Extras implementados:
  - Historial de capítulos recientes
  - Favoritos de versículos (endpoint preparado)
- Inspección completa del repositorio base `C:\facilweb\htdocs\BIBLIASOFT`.
- Validación de estructura SQLite en:
  - `01RVR1960.bbli`
  - `01RVR1960x.bbli`
  - `01RVR1960x.cmti`
  - `strong.lexx`
  - `spurgeon.devx`
- Creación de MVP inicial PHP 7.3:
  - Front controller y routing básico en `public/index.php`.
  - Servicios para lectura bíblica, comentarios por rangos, sanitización HTML, búsqueda y módulo IA (stubs).
  - CRUD de apuntes y vínculos por versículo.
  - Vistas responsive tipo app lector.
- Creación de BD de aplicación independiente en `storage/app.sqlite` (esquema en `app/Database/schema.sql`).
- Script de indexado de búsqueda en `scripts/index_fts.php` (FTS5 + fallback).
- Documentación técnica inicial:
  - `docs/ARQUITECTURA.md`
  - `docs/ROADMAP.md`
  - `docs/LICENCIA_Y_DISTRIBUCION.md`
  - `docs/INSTALACION.md`
